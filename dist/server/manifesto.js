var exjs;!function(t){t.version="0.3.0"}(exjs||(exjs={}));var exjs;!function(t){Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})}(exjs||(exjs={}));var exjs;!function(t){var e=function(){function t(){}return t.prototype.getEnumerator=function(){return{moveNext:function(){return!1},current:void 0}},t.prototype.aggregate=function(t,e){for(var n=t,r=this.getEnumerator();r.moveNext();)n=e(n,r.current);return n},t.prototype.all=function(t){if(t)for(var e=this.getEnumerator(),n=0;e.moveNext();){if(!t(e.current,n))return!1;n++}return!0},t.prototype.any=function(t){for(var e=this.getEnumerator(),n=0;e.moveNext();){if(!t)return!0;if(t(e.current,n))return!0;n++}return!1},t.prototype.apply=function(t){throw new Error("Not implemented")},t.prototype.at=function(t){for(var e=this.getEnumerator(),n=0;e.moveNext();){if(n===t)return e.current;n++}},t.prototype.average=function(t){var e=0,n=0;t=t||function(t){if("number"!=typeof t)throw new Error("Object is not a number.");return t};for(var r=this.getEnumerator();r.moveNext();)n+=t(r.current),e++;return 0===e?0:n/e},t.prototype.concat=function(t){throw new Error("Not implemented")},t.prototype.count=function(t){for(var e=0,n=this.getEnumerator();n.moveNext();)(!t||t(n.current))&&e++;return e},t.prototype.difference=function(t,e){return e=e||function(t,e){return t===e},t instanceof Array&&(t=t.en()),{intersection:this.intersect(t,e).toArray().en(),aNotB:this.except(t,e).toArray().en(),bNotA:t.except(this,e).toArray().en()}},t.prototype.distinct=function(t){throw new Error("Not implemented")},t.prototype.except=function(t,e){throw new Error("Not implemented")},t.prototype.first=function(t){for(var e=this.getEnumerator();e.moveNext();)if(!t||t(e.current))return e.current},t.prototype.firstIndex=function(t){for(var e=this.getEnumerator(),n=0;e.moveNext();n++)if(!t||t(e.current))return n;return-1},t.prototype.forEach=function(t){for(var e=this.getEnumerator();e.moveNext();)t(e.current)},t.prototype.groupBy=function(t,e){throw new Error("Not implemented")},t.prototype.intersect=function(t,e){throw new Error("Not implemented")},t.prototype.join=function(t,e,n,r,o){throw new Error("Not implemented")},t.prototype.last=function(t){for(var e,n=this.getEnumerator();n.moveNext();)(!t||t(n.current))&&(e=n.current);return e},t.prototype.lastIndex=function(t){for(var e=-1,n=this.getEnumerator(),r=0;n.moveNext();r++)(!t||t(n.current))&&(e=r);return e},t.prototype.max=function(t){var e=this.getEnumerator();if(!e.moveNext())return 0;t=t||function(t){if("number"!=typeof t)throw new Error("Object is not a number.");return t};for(var n=t(e.current);e.moveNext();)n=Math.max(n,t(e.current));return n},t.prototype.min=function(t){var e=this.getEnumerator();if(!e.moveNext())return 0;t=t||function(t){if("number"!=typeof t)throw new Error("Object is not a number.");return t};for(var n=t(e.current);e.moveNext();)n=Math.min(n,t(e.current));return n},t.prototype.orderBy=function(t,e){throw new Error("Not implemented")},t.prototype.orderByDescending=function(t,e){throw new Error("Not implemented")},t.prototype.reverse=function(){throw new Error("Not implemented")},t.prototype.select=function(t){throw new Error("Not implemented")},t.prototype.selectMany=function(t){throw new Error("Not implemented")},t.prototype.skip=function(t){throw new Error("Not implemented")},t.prototype.skipWhile=function(t){throw new Error("Not implemented")},t.prototype.standardDeviation=function(t){var e=this.average(t),n=0,r=0;t=t||function(t){if("number"!=typeof t)throw new Error("Object is not a number.");return t};for(var o=this.getEnumerator();o.moveNext();){var i=t(o.current)-e;n+=i*i,r++}return Math.sqrt(n/r)},t.prototype.sum=function(t){var e=0;t=t||function(t){if("number"!=typeof t)throw new Error("Object is not a number.");return t};for(var n=this.getEnumerator();n.moveNext();)e+=t(n.current);return e},t.prototype.take=function(t){throw new Error("Not implemented")},t.prototype.takeWhile=function(t){throw new Error("Not implemented")},t.prototype.traverse=function(t){throw new Error("Not implemented")},t.prototype.traverseUnique=function(t,e){throw new Error("Not implemented")},t.prototype.toArray=function(){for(var t=[],e=this.getEnumerator();e.moveNext();)t.push(e.current);return t},t.prototype.toMap=function(t,e){throw new Error("Not implemented")},t.prototype.toList=function(){throw new Error("Not implemented")},t.prototype.union=function(t,e){throw new Error("Not implemented")},t.prototype.where=function(t){throw new Error("Not implemented")},t.prototype.zip=function(t,e){throw new Error("Not implemented")},t}();t.Enumerable=e}(exjs||(exjs={}));var Symbol,exjs;!function(t){function e(t){var e;return{next:function(){var n={done:!0,value:void 0};return t&&(e=e||t.getEnumerator())?(n.done=!e.moveNext(),n.value=e.current,n):n}}}Symbol&&Symbol.iterator&&(t.Enumerable.prototype[Symbol.iterator]=function(){return e(this)})}(exjs||(exjs={}));var exjs;!function(t){var e=function(){function e(t){this.size=0,this._keys=[],this._values=[];var e;if(t instanceof Array?e=t.en():t&&t.getEnumerator instanceof Function&&(e=t),e)for(var n=e.getEnumerator();n&&n.moveNext();)this.set(n.current[0],n.current[1])}return e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this.size=0},e.prototype["delete"]=function(t){var e=this._keys.indexOf(t);return e>-1?(this._keys.splice(e,1),this._values.splice(e,1),this.size--,!0):!1},e.prototype.entries=function(){var e=this;return t.range(0,this.size).select(function(t){return[e._keys[t],e._values[t]]})},e.prototype.forEach=function(t,e){null==e&&(e=this);for(var n=0,r=this._keys,o=this._values,i=r.length;i>n;n++)t.call(e,o[n],r[n],this)},e.prototype.get=function(t){var e=this._keys.indexOf(t);return this._values[e]},e.prototype.has=function(t){return this._keys.indexOf(t)>-1},e.prototype.keys=function(){return this._keys.en()},e.prototype.set=function(t,e){var n=this._keys.indexOf(t);return void(n>-1?this._values[n]=e:(this._keys.push(t),this._values.push(e),this.size++))},e.prototype.values=function(){return this._values.en()},e}();t.Map3=e,t.Enumerable.prototype.toMap=function(t,n){for(var r=new e,o=this.getEnumerator();o.moveNext();)r.set(t(o.current),n(o.current));return r},t.List&&(t.List.prototype.toMap=t.Enumerable.prototype.toMap)}(exjs||(exjs={})),function(t){t.Map||(t.Map=exjs.Map3)}("undefined"==typeof window?global:window);var exjs;!function(t){function e(t,e){var n,r=0,o={current:void 0,moveNext:function(){return n||(n=t.getEnumerator()),n.moveNext()?(e(o.current=n.current,r),r++,!0):!1}};return o}t.Enumerable.prototype.apply=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.List&&(t.List.prototype.apply=t.Enumerable.prototype.apply)}(exjs||(exjs={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},exjs;!function(t){function e(t){var e=t.length,n={moveNext:void 0,current:void 0},r=-1;return n.moveNext=function(){return r++,r>=e?(n.current=void 0,!1):(n.current=t[r],!0)},n}function n(){return this&&Array.isArray(this)?new r(this):new t.Enumerable}var r=function(t){function n(n){t.call(this),this.getEnumerator=function(){return e(n)},this.toArray=function(){return n.slice(0)}}return __extends(n,t),n}(t.Enumerable);try{Object.defineProperty(Array.prototype,"en",{value:n,enumerable:!1,writable:!1,configurable:!1})}catch(o){Array.prototype.en=n}}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){var n,r=!1,o={current:void 0,moveNext:function(){return n||(n=t.getEnumerator()),o.current=void 0,n.moveNext()?(o.current=n.current,!0):r?!1:(r=!0,n=e.getEnumerator(),n.moveNext()?(o.current=n.current,!0):!1)}};return o}t.Enumerable.prototype.concat=function(n){var r=this,o=n instanceof Array?n.en():n,i=new t.Enumerable;return i.getEnumerator=function(){return e(r,o)},i},t.List&&(t.List.prototype.concat=t.Enumerable.prototype.concat)}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){var n,r=[],o={current:void 0,moveNext:function(){if(n||(n=t.getEnumerator()),o.current=void 0,!e){for(;n.moveNext();)if(r.indexOf(n.current)<0)return r.push(o.current=n.current),!0;return!1}for(;n.moveNext();){for(var i=0,a=r.length,u=!1;a>i&&!u;i++)u=!!e(r[i],n.current);if(!u)return r.push(o.current=n.current),!0}return!1}};return o}t.Enumerable.prototype.distinct=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.List&&(t.List.prototype.distinct=t.Enumerable.prototype.distinct)}(exjs||(exjs={}));var exjs;!function(t){function e(t,e,n){n=n||function(t,e){return t===e};var r,o={current:void 0,moveNext:function(){for(r||(r=t.getEnumerator()),o.current=void 0;r.moveNext();){for(var i=!1,a=e.getEnumerator();a.moveNext()&&!i;)i=n(r.current,a.current);if(!i)return o.current=r.current,!0}return!1}};return o}t.Enumerable.prototype.except=function(n,r){var o=this,i=n instanceof Array?n.en():n,a=new t.Enumerable;return a.getEnumerator=function(){return e(o,i,r)},a},t.List&&(t.List.prototype.except=t.Enumerable.prototype.except)}(exjs||(exjs={})),Function.prototype.fromJson=function(t,e){function n(t,e){if(null==t)return t;if(e instanceof Function)return e(t);if(e instanceof Array){if(e=e[0],!(e instanceof Function&&t instanceof Array))return;for(var n=[],r=0;r<t.length;r++)n.push(e(t[r]));return n}}var r=new this;if(null==t)return r;var o=[];for(var i in e){var a=n(t[i],e[i]);void 0!==a&&(r[i]=a,o.push(i))}for(var i in this.$jsonMappings)if(!(o.indexOf(i)>-1)){var a=n(t[i],this.$jsonMappings[i]);void 0!==a&&(r[i]=a,o.push(i))}for(var i in t)o.indexOf(i)>-1||(r[i]=t[i]);return r};var exjs;!function(t){function e(t,e,r){var o,i=0,a={current:void 0,moveNext:function(){return o||(o=n(t,e,r)),a.current=void 0,i>=o.length?!1:(a.current=o[i],i++,!0)}};return a}function n(t,e,n){n=n||function(t,e){return t===e};for(var o,i=[],a=[],u=t.getEnumerator();u.moveNext();){o=e(u.current);for(var s=-1,c=0,f=a.length;f>c;c++)if(n(o,a[c])){s=c;break}var p;0>s?(a.push(o),i.push(p=new r(o))):p=i[s],p._add(u.current)}return i}var r=function(t){function e(e){var n=this;t.call(this),this.key=e,this._arr=[],this.getEnumerator=function(){return n._arr.en().getEnumerator()}}return __extends(e,t),e.prototype._add=function(t){this._arr.push(t)},e}(t.Enumerable);t.Enumerable.prototype.groupBy=function(n,r){var o=this,i=new t.Enumerable;return i.getEnumerator=function(){return e(o,n,r)},i},t.List&&(t.List.prototype.groupBy=t.Enumerable.prototype.groupBy)}(exjs||(exjs={}));var exjs;!function(t){function e(e,n,r){r=r||function(t,e){return t===e};var o,i={current:void 0,moveNext:function(){for(o||(o=t.en(e).distinct().getEnumerator()),i.current=void 0;o.moveNext();){for(var a=!1,u=n.getEnumerator();u.moveNext()&&!a;)a=r(o.current,u.current);if(a)return i.current=o.current,!0}return!1}};return i}t.Enumerable.prototype.intersect=function(n,r){var o=this,i=n instanceof Array?n.en():n,a=new t.Enumerable;return a.getEnumerator=function(){return e(o,i,r)},a},t.List&&(t.List.prototype.intersect=t.Enumerable.prototype.intersect)}(exjs||(exjs={}));var exjs;!function(t){function e(e,n,r,o,i,a){a=a||function(t,e){return t===e};var u,s,c=0,f={current:void 0,moveNext:function(){if(f.current=void 0,!u){if(u=e.getEnumerator(),!u.moveNext())return!1;s=t.en(n).toArray()}var p;do{for(;c<s.length;c++)if(p=s[c],a(r(u.current),o(p)))return c++,f.current=i(u.current,p),!0;c=0}while(u.moveNext());return!1}};return f}t.Enumerable.prototype.join=function(n,r,o,i,a){var u=this,s=n instanceof Array?n.en():n,c=new t.Enumerable;return c.getEnumerator=function(){return e(u,s,r,o,i,a)},c},t.List&&(t.List.prototype.join=t.Enumerable.prototype.join)}(exjs||(exjs={}));var exjs;!function(t){function e(){this.constructor=n}t.Enumerable.prototype.toList=function(){for(var t=new n,e=this.getEnumerator();e.moveNext();)t.push(e.current);return t};var n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.toString=function(){throw new Error("Not implemented")},e.prototype.toLocaleString=function(){throw new Error("Not implemented")},e.prototype.pop=function(){throw new Error("Not implemented")},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];throw new Error("Not implemented")},e.prototype.shift=function(){throw new Error("Not implemented")},e.prototype.slice=function(t,e){throw new Error("Not implemented")},e.prototype.sort=function(t){throw new Error("Not implemented")},e.prototype.splice=function(){throw new Error("Not implemented")},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];throw new Error("Not implemented")},e.prototype.indexOf=function(t,e){throw new Error("Not implemented")},e.prototype.lastIndexOf=function(t,e){throw new Error("Not implemented")},e.prototype.every=function(t,e){throw new Error("Not implemented")},e.prototype.some=function(t,e){throw new Error("Not implemented")},e.prototype.forEach=function(t,e){throw new Error("Not implemented")},e.prototype.map=function(t,e){throw new Error("Not implemented")},e.prototype.filter=function(t,e){throw new Error("Not implemented")},e.prototype.reduce=function(t,e){throw new Error("Not implemented")},e.prototype.reduceRight=function(t,e){throw new Error("Not implemented")},e.prototype.remove=function(t){throw new Error("Not implemented")},e.prototype.removeWhere=function(t){throw new Error("Not implemented")},e}(t.Enumerable);t.List=n;for(var r in Array)Array.hasOwnProperty(r)&&(n[r]=Array[r]);e.prototype=Array.prototype,n.prototype=new e;for(var o in t.Enumerable.prototype)"getEnumerator"!==o&&(n.prototype[o]=t.Enumerable.prototype[o]);n.prototype.getEnumerator=function(){var t=this,e=t.length,n={moveNext:void 0,current:void 0},r=-1;return n.moveNext=function(){return r++,r>=e?(n.current=void 0,!1):(n.current=t[r],!0)},n},n.prototype.remove=function(t){return this.removeWhere(function(e){return e===t}).any()},n.prototype.removeWhere=function(t){for(var e,n=[],r=this.length-1;r>=0;r--)e=this[r],t(e,r)===!0&&(this.splice(r,1),n.push(e));return n.en().reverse()}}(exjs||(exjs={}));var exjs;!function(t){function e(t,e,r,o){return new n(t,e,r,o)}var n=function(e){function n(t,n,r,o){e.call(this),this.Source=t,o=o||function(t,e){return t>e?1:e>t?-1:0};var i=r===!0?-1:1;this.Sorter=function(t,e){return i*o(n(t),n(e))}}return __extends(n,e),n.prototype.getEnumerator=function(){var e,n=this.Source,r=this.Sorter,o=0,i={current:void 0,moveNext:function(){return e||(e=t.en(n).toArray(),e.sort(r)),i.current=void 0,o>=e.length?!1:(i.current=e[o],o++,!0)}};return i},n.prototype.thenBy=function(t,e){return new r(this,t,!1,e)},n.prototype.thenByDescending=function(t,e){return new r(this,t,!0,e)},n}(t.Enumerable),r=function(t){function e(e,n,r,o){t.call(this,e,n,r,o);var i=e.Sorter,a=this.Sorter;this.Sorter=function(t,e){return i(t,e)||a(t,e)}}return __extends(e,t),e}(n),o=t.Enumerable.prototype;o.orderBy=function(t,n){return e(this,t,!1,n)},o.orderByDescending=function(t,n){return e(this,t,!0,n)},t.List&&(t.List.prototype.orderBy=t.Enumerable.prototype.orderBy,t.List.prototype.orderByDescending=t.Enumerable.prototype.orderByDescending)}(exjs||(exjs={}));var exjs;!function(t){function e(t,e,n){var r=t-n,o={current:void 0,moveNext:function(){return r+=n,r>=e?!1:(o.current=r,!0)}};return o}function n(n,r,o){if(n=n||0,r=r||0,n>r)throw new Error("Start cannot be greater than end.");null==o&&(o=1);var i=new t.Enumerable;return i.getEnumerator=function(){return e(n,r,o)},i}t.range=n}(exjs||(exjs={}));var exjs;!function(t){function e(e){var n,r=0,o={current:void 0,moveNext:function(){return n||(n=t.en(e).toArray(),r=n.length),r--,o.current=n[r],r>=0}};return o}t.Enumerable.prototype.reverse=function(){var n=this,r=new t.Enumerable;return r.getEnumerator=function(){return e(n)},r},t.List&&(t.List.prototype.reverse=t.Enumerable.prototype.reverse)}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){if(e=e||0,0===e)return Math.round(t);var n=Math.pow(10,e);return Math.round(t*n)/n}t.round=e}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){var n,r=0,o={current:void 0,moveNext:function(){return n||(n=t.getEnumerator()),n.moveNext()?(o.current=e(n.current,r),r++,!0):!1}};return o}function n(e,n){var r,o,i={current:void 0,moveNext:function(){for(i.current=void 0,r||(r=e.getEnumerator());!o||!o.moveNext();){if(!r.moveNext())return!1;o=t.selectorEnumerator(n(r.current))}return i.current=o.current,!0}};return i}t.Enumerable.prototype.select=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.Enumerable.prototype.selectMany=function(e){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return n(r,e)},o},t.List&&(t.List.prototype.select=t.Enumerable.prototype.select,t.List.prototype.selectMany=t.Enumerable.prototype.selectMany)}(exjs||(exjs={}));var exjs;!function(t){function e(t){return Array.isArray(t)?t.en().getEnumerator():null!=t&&"function"==typeof t.getEnumerator?t.getEnumerator():null}t.selectorEnumerator=e}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){var n,r={current:void 0,moveNext:function(){if(!n){n=t.getEnumerator();for(var o=0;e>o;o++)if(!n.moveNext())return!1}return n.moveNext()?(r.current=n.current,!0):(r.current=void 0,!1)}};return r}function n(t,e){var n,r={current:void 0,moveNext:function(){if(!n){n=t.getEnumerator();for(var o=0;n.moveNext();o++)if(!e(r.current=n.current,o))return!0;return r.current=void 0,!1}return n.moveNext()?(r.current=n.current,!0):(r.current=void 0,!1)}};return r}t.Enumerable.prototype.skip=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.Enumerable.prototype.skipWhile=function(e){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return n(r,e)},o},t.List&&(t.List.prototype.skip=t.Enumerable.prototype.skip,t.List.prototype.skipWhile=t.Enumerable.prototype.skipWhile)}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){var n,r=0,o={current:void 0,moveNext:function(){return n||(n=t.getEnumerator()),r++,r>e?!1:(o.current=void 0,n.moveNext()?(o.current=n.current,!0):!1)}};return o}function n(t,e){var n,r=0,o={current:void 0,moveNext:function(){return n||(n=t.getEnumerator()),n.moveNext()&&e(n.current,r)?(r++,o.current=n.current,!0):(o.current=void 0,!1)}};return o}t.Enumerable.prototype.take=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.Enumerable.prototype.takeWhile=function(e){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return n(r,e)},o},t.List&&(t.List.prototype.take=t.Enumerable.prototype.take,t.List.prototype.takeWhile=t.Enumerable.prototype.takeWhile)}(exjs||(exjs={}));var exjs;!function(t){function e(e,n){var r,o=!1,i=[],a={current:void 0,moveNext:function(){if(o){if(null==r)return!1;i.push(r),r=t.selectorEnumerator(n(a.current))}else r=e.getEnumerator(),o=!0;for(;!(r&&r.moveNext()||i.length<1);)r=i.pop();return a.current=null==r?void 0:r.current,void 0!==a.current}};return a}function n(e,n,r){var o,i=!1,a=[],u={current:void 0,moveNext:function(){if(i){if(null==o)return!1;a.push(o),o=t.selectorEnumerator(n(u.current))}else o=e.getEnumerator(),i=!0;do{for(;!(o&&o.moveNext()||a.length<1);)o=a.pop();u.current=null==o?void 0:o.current}while(r(u.current));return void 0!==u.current}};return u}t.Enumerable.prototype.traverse=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.Enumerable.prototype.traverseUnique=function(e,r){var o=this,i=[],a=new t.Enumerable;return r?a.getEnumerator=function(){return n(o,e,function(t){return i.some(function(e){return r(t,e)})?!0:(i.push(t),!1)})}:a.getEnumerator=function(){return n(o,e,function(t){return i.indexOf(t)>-1?!0:(i.push(t),!1)})},a},t.List&&(t.List.prototype.traverse=t.Enumerable.prototype.traverse,t.List.prototype.traverseUnique=t.Enumerable.prototype.traverseUnique)}(exjs||(exjs={}));var exjs;!function(t){function e(e,n,r){r=r||function(t,e){return t===e};var o,i,a=[],u={current:void 0,moveNext:function(){if(o||(o=t.en(e).distinct().getEnumerator()),u.current=void 0,!i&&o.moveNext())return a.push(u.current=o.current),!0;for(i=i||t.en(n).distinct().getEnumerator();i.moveNext();){for(var s=0,c=!1,f=a.length;f>s&&!c;s++)c=r(a[s],i.current);if(!c)return u.current=i.current,!0}return!1}};return u}t.Enumerable.prototype.union=function(n,r){var o=this,i=n instanceof Array?n.en():n,a=new t.Enumerable;return a.getEnumerator=function(){return e(o,i,r)},a},t.List&&(t.List.prototype.union=t.Enumerable.prototype.union)}(exjs||(exjs={}));var exjs;!function(t){function e(t,e){var n,r={current:void 0,moveNext:function(){n||(n=t.getEnumerator());for(var o;n.moveNext();)if(e(o=n.current))return r.current=o,!0;return!1}};return r}t.Enumerable.prototype.where=function(n){var r=this,o=new t.Enumerable;return o.getEnumerator=function(){return e(r,n)},o},t.List&&(t.List.prototype.where=t.Enumerable.prototype.where)}(exjs||(exjs={}));var exjs;!function(t){function e(e){var r=new t.Enumerable;return r.getEnumerator=function(){return n(e)},r}function n(t){var e=t.getEnumerator(),n={current:void 0,moveNext:void 0};return n.moveNext=function(){return e.moveNext()?(n.current=e.current,!0):(n.current=void 0,!1)},n}t.en=e}(exjs||(exjs={}));var ex=exjs.en,exjs;!function(t){function e(t,e,n){var r,o,i={current:void 0,moveNext:function(){return r||(r=t.getEnumerator()),o||(o=e.getEnumerator()),i.current=void 0,r.moveNext()&&o.moveNext()?(i.current=n(r.current,o.current),!0):!1}};return i}t.Enumerable.prototype.zip=function(n,r){var o=this,i=n instanceof Array?n.en():n,a=new t.Enumerable;return a.getEnumerator=function(){return e(o,i,r)},a},t.List&&(t.List.prototype.zip=t.Enumerable.prototype.zip)}(exjs||(exjs={})),Array.prototype.clone||(Array.prototype.clone=function(){return this.slice(0)}),Array.prototype.contains||(Array.prototype.contains=function(t){return-1!==this.indexOf(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var n=e||0,r=this.length;for(n;r>n;n++)if(this[n]===t)return n;return-1}),Array.prototype.indexOfTest=function(t,e){var n=e||0,r=this.length;for(n;r>n;n++)if(t(this[n]))return n;return-1},Array.prototype.insert=function(t,e){this.splice(e,0,t)},Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]}),Array.prototype.move=function(t,e){this.splice(e,0,this.splice(t,1)[0])},Array.prototype.remove=function(t){var e=this.indexOf(t);e>-1&&this.splice(e,1)},Array.prototype.removeAt=function(t){this.splice(t,1)},Math.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},Math.constrain=function(t,e,n){return Math.clamp(t,e,n)},Math.degreesToRadians=function(t){return Math.TAU*(t/360)},Math.distanceBetween=function(t,e,n,r){return Math.sqrt(Math.sq(n-t)+Math.sq(r-e))},Math.lerp=function(t,e,n){return t+(e-t)*n},Math.mag=function(t,e,n){return Math.sqrt(t*t+e*e+n*n)},Math.map=function(t,e,n,r,o){return r+(o-r)*((t-e)/(n-e))},Math.median=function(t){t.sort(function(t,e){return t-e});var e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},Math.normalise=function(t,e,n){return(t-e)/(n-e)},Math.radiansToDegrees=function(t){return 360*t/Math.TAU},Math.randomBetween=function(t,e){return e||(e=t,t=0),t>=e?t:t+(e-t)*Math.random()},Math.roundToDecimalPlace=function(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)},Math.sq=function(t){return t*t},Math.TAU=2*Math.PI,Number.prototype.isInteger||(Number.prototype.isInteger=function(){return this%1===0}),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(o){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError("Object.keys called on non-object");var i=[];for(var a in o)t.call(o,a)&&i.push(a);if(e)for(var u=0;r>u;u++)t.call(o,n[u])&&i.push(n[u]);return i}}()),String.prototype.b64_to_utf8=function(){return decodeURIComponent(escape(window.atob(this)))},String.prototype.contains=function(t){return-1!==this.indexOf(t)},String.prototype.endsWith||(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)}),String.format=function(){for(var t=arguments[0],e=0;e<arguments.length-1;e++){var n=new RegExp("\\{"+e+"\\}","gm");t=t.replace(n,arguments[e+1])}return t},String.prototype.hashCode=function(){var t,e,n,r=0;if(0==this.length)return r;for(t=0,n=this.length;n>t;t++)e=this.charCodeAt(t),r=(r<<5)-r+e,r|=0;return r.toString()},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.startsWith||(String.prototype.startsWith=function(t){return 0==this.indexOf(t)}),String.prototype.toCssClass=function(){return this.replace(/[^a-z0-9]/g,function(t){var e=t.charCodeAt(0);return 32==e?"-":e>=65&&90>=e?"_"+t.toLowerCase():"__"+("000"+e.toString(16)).slice(-4)})},String.prototype.toFileName=function(){return this.replace(/[^a-z0-9]/gi,"_").toLowerCase()},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}),String.prototype.utf8_to_b64=function(){return window.btoa(unescape(encodeURIComponent(this)))};var Manifesto;!function(t){var e=function(){function t(t){this.value="",t&&(this.value=t.toLowerCase())}return t.prototype.toString=function(){return this.value},t}();t.StringValue=e}(Manifesto||(Manifesto={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.bookmarking=function(){return new e(e.BOOKMARKING.toString())},e.prototype.classifying=function(){return new e(e.CLASSIFYING.toString())},e.prototype.commenting=function(){return new e(e.COMMENTING.toString())},e.prototype.describing=function(){return new e(e.DESCRIBING.toString())},e.prototype.editing=function(){return new e(e.EDITING.toString())},e.prototype.highlighting=function(){return new e(e.HIGHLIGHTING.toString())},e.prototype.identifying=function(){return new e(e.IDENTIFYING.toString())},e.prototype.linking=function(){return new e(e.LINKING.toString())},e.prototype.moderating=function(){return new e(e.MODERATING.toString())},e.prototype.painting=function(){return new e(e.PAINTING.toString())},e.prototype.questioning=function(){return new e(e.QUESTIONING.toString())},e.prototype.replying=function(){return new e(e.REPLYING.toString())},e.prototype.tagging=function(){return new e(e.TAGGING.toString())},e.prototype.transcribing=function(){return new e(e.TRANSCRIBING.toString())},e.BOOKMARKING=new e("oa:bookmarking"),e.CLASSIFYING=new e("oa:classifying"),e.COMMENTING=new e("oa:commenting"),e.DESCRIBING=new e("oa:describing"),e.EDITING=new e("oa:editing"),e.HIGHLIGHTING=new e("oa:highlighting"),e.IDENTIFYING=new e("oa:identifying"),e.LINKING=new e("oa:linking"),e.MODERATING=new e("oa:moderating"),e.PAINTING=new e("sc:painting"),e.QUESTIONING=new e("oa:questioning"),e.REPLYING=new e("oa:replying"),e.TAGGING=new e("oa:tagging"),e.TRANSCRIBING=new e("oad:transcribing"),e}(t.StringValue);t.AnnotationMotivation=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.canvas=function(){return new e(e.CANVAS.toString())},e.prototype.document=function(){return new e(e.DOCUMENT.toString())},e.prototype.image=function(){return new e(e.IMAGE.toString())},e.prototype.movingimage=function(){return new e(e.MOVINGIMAGE.toString())},e.prototype.physicalobject=function(){return new e(e.PHYSICALOBJECT.toString())},e.prototype.sound=function(){return new e(e.SOUND.toString())},e.CANVAS=new e("sc:canvas"),e.DOCUMENT=new e("foaf:document"),e.IMAGE=new e("dcTypes:image"),e.MOVINGIMAGE=new e("dctypes:movingimage"),e.PHYSICALOBJECT=new e("dctypes:physicalobject"),e.SOUND=new e("dctypes:sound"),e}(t.StringValue);t.ElementType=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.manifest=function(){return new e(e.MANIFEST.toString())},e.prototype.collection=function(){return new e(e.COLLECTION.toString())},e.MANIFEST=new e("sc:manifest"),e.COLLECTION=new e("sc:collection"),e}(t.StringValue);t.IIIFResourceType=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.empty=function(){return new e(e.EMPTY.toString())},e.prototype.manuscript=function(){return new e(e.MANUSCRIPT.toString())},e.prototype.monograph=function(){return new e(e.MONOGRAPH.toString())},e.EMPTY=new e(""),e.MANUSCRIPT=new e("manuscript"),e.MONOGRAPH=new e("monograph"),e}(t.StringValue);t.ManifestType=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.pdf=function(){return new e(e.PDF.toString())},e.prototype.doc=function(){return new e(e.DOC.toString())},e.prototype.docx=function(){return new e(e.DOCX.toString())},e.PDF=new e("application/pdf"),e.DOC=new e("application/msword"),e.DOCX=new e("application/vnd.openxmlformats-officedocument.wordprocessingml.document"),e}(t.StringValue);t.RenderingFormat=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.jpgimage=function(){return new e(e.JPGIMAGE.toString())},e.prototype.pdf=function(){return new e(e.PDF.toString())},e.JPGIMAGE=new e("image/jpeg"),e.PDF=new e("application/pdf"),e}(t.StringValue);t.ResourceFormat=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.image=function(){return new e(e.IMAGE.toString())},e.IMAGE=new e("dctypes:image"),e}(t.StringValue);t.ResourceType=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.autoComplete=function(){return new e(e.AUTOCOMPLETE.toString())},e.prototype.iiif1ImageLevel1=function(){return new e(e.IIIF1IMAGELEVEL1.toString())},e.prototype.iiif1ImageLevel2=function(){return new e(e.IIIF1IMAGELEVEL2.toString())},e.prototype.iiif2ImageLevel1=function(){return new e(e.IIIF2IMAGELEVEL1.toString())},e.prototype.iiif2ImageLevel2=function(){return new e(e.IIIF2IMAGELEVEL2.toString())},e.prototype.ixif=function(){return new e(e.IXIF.toString())},e.prototype.login=function(){return new e(e.LOGIN.toString())},e.prototype.clickThrough=function(){return new e(e.CLICKTHROUGH.toString())},e.prototype.restricted=function(){return new e(e.RESTRICTED.toString())},e.prototype.logout=function(){return new e(e.LOGOUT.toString())},e.prototype.otherManifestations=function(){return new e(e.OTHERMANIFESTATIONS.toString())},e.prototype.searchWithin=function(){return new e(e.SEARCHWITHIN.toString())},e.prototype.stanfordIIIFImageCompliance1=function(){return new e(e.STANFORDIIIFIMAGECOMPLIANCE1.toString())},e.prototype.stanfordIIIFImageCompliance2=function(){return new e(e.STANFORDIIIFIMAGECOMPLIANCE2.toString())},e.prototype.stanfordIIIFImageConformance1=function(){return new e(e.STANFORDIIIFIMAGECONFORMANCE1.toString())},e.prototype.stanfordIIIFImageConformance2=function(){return new e(e.STANFORDIIIFIMAGECONFORMANCE2.toString())},e.prototype.stanfordIIIF1ImageCompliance1=function(){return new e(e.STANFORDIIIF1IMAGECOMPLIANCE1.toString())},e.prototype.stanfordIIIF1ImageCompliance2=function(){return new e(e.STANFORDIIIF1IMAGECOMPLIANCE2.toString())},e.prototype.stanfordIIIF1ImageConformance1=function(){
return new e(e.STANFORDIIIF1IMAGECONFORMANCE1.toString())},e.prototype.stanfordIIIF1ImageConformance2=function(){return new e(e.STANFORDIIIF1IMAGECONFORMANCE2.toString())},e.prototype.token=function(){return new e(e.TOKEN.toString())},e.prototype.trackingExtensions=function(){return new e(e.TRACKINGEXTENSIONS.toString())},e.prototype.uiExtensions=function(){return new e(e.UIEXTENSIONS.toString())},e.AUTOCOMPLETE=new e("http://iiif.io/api/search/0/autocomplete"),e.STANFORDIIIFIMAGECOMPLIANCE0=new e("http://library.stanford.edu/iiif/image-api/compliance.html#level0"),e.STANFORDIIIFIMAGECOMPLIANCE1=new e("http://library.stanford.edu/iiif/image-api/compliance.html#level1"),e.STANFORDIIIFIMAGECOMPLIANCE2=new e("http://library.stanford.edu/iiif/image-api/compliance.html#level2"),e.STANFORDIIIFIMAGECONFORMANCE0=new e("http://library.stanford.edu/iiif/image-api/conformance.html#level0"),e.STANFORDIIIFIMAGECONFORMANCE1=new e("http://library.stanford.edu/iiif/image-api/conformance.html#level1"),e.STANFORDIIIFIMAGECONFORMANCE2=new e("http://library.stanford.edu/iiif/image-api/conformance.html#level2"),e.STANFORDIIIF1IMAGECOMPLIANCE0=new e("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0"),e.STANFORDIIIF1IMAGECOMPLIANCE1=new e("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1"),e.STANFORDIIIF1IMAGECOMPLIANCE2=new e("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2"),e.STANFORDIIIF1IMAGECONFORMANCE0=new e("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0"),e.STANFORDIIIF1IMAGECONFORMANCE1=new e("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1"),e.STANFORDIIIF1IMAGECONFORMANCE2=new e("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2"),e.IIIF1IMAGELEVEL0=new e("http://iiif.io/api/image/1/level0.json"),e.IIIF1IMAGELEVEL0PROFILE=new e("http://iiif.io/api/image/1/profiles/level0.json"),e.IIIF1IMAGELEVEL1=new e("http://iiif.io/api/image/1/level1.json"),e.IIIF1IMAGELEVEL1PROFILE=new e("http://iiif.io/api/image/1/profiles/level1.json"),e.IIIF1IMAGELEVEL2=new e("http://iiif.io/api/image/1/level2.json"),e.IIIF1IMAGELEVEL2PROFILE=new e("http://iiif.io/api/image/1/profiles/level2.json"),e.IIIF2IMAGELEVEL0=new e("http://iiif.io/api/image/2/level0.json"),e.IIIF2IMAGELEVEL0PROFILE=new e("http://iiif.io/api/image/2/profiles/level0.json"),e.IIIF2IMAGELEVEL1=new e("http://iiif.io/api/image/2/level1.json"),e.IIIF2IMAGELEVEL1PROFILE=new e("http://iiif.io/api/image/2/profiles/level1.json"),e.IIIF2IMAGELEVEL2=new e("http://iiif.io/api/image/2/level2.json"),e.IIIF2IMAGELEVEL2PROFILE=new e("http://iiif.io/api/image/2/profiles/level2.json"),e.IXIF=new e("http://wellcomelibrary.org/ld/ixif/0/alpha.json"),e.LOGIN=new e("http://iiif.io/api/auth/0/login"),e.CLICKTHROUGH=new e("http://iiif.io/api/auth/0/login/clickthrough"),e.RESTRICTED=new e("http://iiif.io/api/auth/0/login/restricted"),e.LOGOUT=new e("http://iiif.io/api/auth/0/logout"),e.OTHERMANIFESTATIONS=new e("http://iiif.io/api/otherManifestations.json"),e.SEARCHWITHIN=new e("http://iiif.io/api/search/0/search"),e.TOKEN=new e("http://iiif.io/api/auth/0/token"),e.TRACKINGEXTENSIONS=new e("http://universalviewer.io/tracking-extensions-profile"),e.UIEXTENSIONS=new e("http://universalviewer.io/ui-extensions-profile"),e}(t.StringValue);t.ServiceProfile=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.leftToRight=function(){return new e(e.LEFTTORIGHT.toString())},e.prototype.rightToLeft=function(){return new e(e.RIGHTTOLEFT.toString())},e.prototype.topToBottom=function(){return new e(e.TOPTOBOTTOM.toString())},e.prototype.bottomToTop=function(){return new e(e.BOTTOMTOTOP.toString())},e.LEFTTORIGHT=new e("left-to-right"),e.RIGHTTOLEFT=new e("right-to-left"),e.TOPTOBOTTOM=new e("top-to-bottom"),e.BOTTOMTOTOP=new e("bottom-to-top"),e}(t.StringValue);t.ViewingDirection=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.continuous=function(){return new e(e.CONTINUOUS.toString())},e.prototype.empty=function(){return new e(e.EMPTY.toString())},e.prototype.individuals=function(){return new e(e.INDIVIDUALS.toString())},e.prototype.nonPaged=function(){return new e(e.NONPAGED.toString())},e.prototype.paged=function(){return new e(e.PAGED.toString())},e.prototype.top=function(){return new e(e.TOP.toString())},e.CONTINUOUS=new e("continuous"),e.EMPTY=new e(""),e.INDIVIDUALS=new e("individuals"),e.NONPAGED=new e("non-paged"),e.PAGED=new e("paged"),e.TOP=new e("top"),e}(t.StringValue);t.ViewingHint=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(){function t(t){this.__jsonld=t,this.context=this.getProperty("@context"),this.id=this.getProperty("@id")}return t.prototype.getProperty=function(t){return this.__jsonld[t]},t}();t.JSONLDResource=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t),this.options=n}return __extends(n,e),n.prototype.getLabel=function(){return t.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},n.prototype.getMetadata=function(){var e=this.getProperty("metadata");if(!e)return[];for(var n=0;n<e.length;n++){var r=e[n];r.label=t.Utils.getLocalisedValue(r.label,this.options.locale),r.value=t.Utils.getLocalisedValue(r.value,this.options.locale)}return e},n.prototype.getRendering=function(t){var e=this.getRenderings();"string"!=typeof t&&(t=t.toString());for(var n=0;n<e.length;n++){var r=e[n];if(r.getFormat().toString()===t)return r}return null},n.prototype.getRenderings=function(){var e;e=this.__jsonld?this.__jsonld.rendering:this.rendering;var n=[];if(!e)return n;_isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var o=e[r];n.push(new t.Rendering(o,this.options))}return n},n.prototype.getService=function(e){return t.Utils.getService(this,e)},n.prototype.getServices=function(){return t.Utils.getServices(this)},n}(t.JSONLDResource);t.ManifestResource=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.getResources=function(){var e=[];if(!this.__jsonld.resources)return e;for(var n=0;n<this.__jsonld.resources.length;n++){var r=this.__jsonld.resources[n],o=new t.Annotation(r,this.options);e.push(o)}return e},n.prototype.getType=function(){return new t.ElementType(this.getProperty("@type"))},n}(t.ManifestResource);t.Element=e}(Manifesto||(Manifesto={}));var _endsWith=require("lodash.endswith"),_last=require("lodash.last"),Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.getCanonicalImageUri=function(e){var n,r,o="full",i=0,a="default",u=e;if(this.externalResource&&this.externalResource.data)n=this.externalResource.data["@id"],u||(u=this.externalResource.data.width),(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(a="native");else{var s=this.getImages();if(!s||!s.length)return null;var c=s[0],f=c.getResource(),p=f.getServices();u||(u=f.getWidth());var l=p[0];n=l.id,a=t.Utils.getImageQuality(l.getProfile())}r=u+",";var g=[n,o,r,i,a+".jpg"].join("/");return g},n.prototype.getImages=function(){var e=[];if(!this.__jsonld.images)return e;for(var n=0;n<this.__jsonld.images.length;n++){var r=this.__jsonld.images[n],o=new t.Annotation(r,this.options);e.push(o)}return e},n.prototype.getIndex=function(){return this.getProperty("index")},n.prototype.getWidth=function(){return this.getProperty("width")},n.prototype.getHeight=function(){return this.getProperty("height")},n}(t.Element);t.Canvas=e}(Manifesto||(Manifesto={}));var _assign=require("lodash.assign"),Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n),this.index=0,this.isLoaded=!1;var r={defaultLabel:"-",locale:"en-GB",resource:this,pessimisticAccessControl:!1};this.options=_assign(r,n)}return __extends(n,e),n.prototype.generateTreeNodeIds=function(t,e){void 0===e&&(e=0);var n;n=t.parentNode?t.parentNode.id+"/"+e:"0",t.id=n.hashCode();for(var r=0;r<t.nodes.length;r++){var o=t.nodes[r];this.generateTreeNodeIds(o,r)}},n.prototype.getAttribution=function(){return t.Utils.getLocalisedValue(this.getProperty("attribution"),this.options.locale)},n.prototype.getDescription=function(){return t.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},n.prototype.getIIIFResourceType=function(){return new t.IIIFResourceType(this.getProperty("@type"))},n.prototype.getLogo=function(){var t=this.getProperty("logo");return t?_isString(t)?t:t["@id"]:null},n.prototype.getLicense=function(){return t.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},n.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},n.prototype.getSeeAlso=function(){return t.Utils.getLocalisedValue(this.getProperty("seeAlso"),this.options.locale)},n.prototype.getLabel=function(){return t.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},n.prototype.getTree=function(){return this.treeRoot=new t.TreeNode("root"),this.treeRoot.data=this,this.treeRoot},n.prototype.load=function(){var e=this;return new Promise(function(n,r){if(e.isLoaded)n(e);else{var o=e.options;o.navDate=e.getNavDate(),t.Utils.loadResource(e.__jsonld["@id"]).then(function(r){e.parentLabel=e.getLabel();var i=t.Deserialiser.parse(r,o);e=_assign(e,i),n(e)})}})},n}(t.ManifestResource);t.IIIFResource=e}(Manifesto||(Manifesto={}));var _isArray=require("lodash.isarray"),_map=require("lodash.map"),Manifesto;!function(t){var e=function(e){function n(t,n){if(e.call(this,t,n),this.index=0,this._ranges=null,this._sequences=null,this.__jsonld.structures&&this.__jsonld.structures.length){var r=this._getRootRange();this._parseRanges(r,"")}}return __extends(n,e),n.prototype._getRootRange=function(){var e;if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var n=0;n<this.__jsonld.structures.length;n++){var r=this.__jsonld.structures[n];r.viewingHint===t.ViewingHint.TOP.toString()&&(e=r)}e||(e={},e.ranges=this.__jsonld.structures)}return e},n.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var e=0;e<this.__jsonld.structures.length;e++){var n=this.__jsonld.structures[e];if(n["@id"]===t)return n}return null},n.prototype._parseRanges=function(e,n,r){var o;if(_isString(e)&&(e=this._getRangeById(e)),o=new t.Range(e,this.options),r?(o.parentRange=r,r.ranges.push(o)):this.rootRange=o,o.path=n,e.ranges)for(var i=0;i<e.ranges.length;i++)this._parseRanges(e.ranges[i],n+"/"+i,o)},n.prototype.getRanges=function(){return null!=this._ranges?this._ranges:(this._ranges=[],this.rootRange&&(this._ranges=this.rootRange.ranges.en().traverseUnique(function(t){return t.ranges}).toArray()),this._ranges)},n.prototype.getRangeById=function(t){for(var e=this.getRanges(),n=0;n<e.length;n++){var r=e[n];if(r.id===t)return r}return null},n.prototype.getRangeByPath=function(t){for(var e=this.getRanges(),n=0;n<e.length;n++){var r=e[n];if(r.path===t)return r}return null},n.prototype.getSequences=function(){if(null!=this._sequences)return this._sequences;this._sequences=[];var e=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(e)for(var n=0;n<e.length;n++){var r=e[n],o=new t.Sequence(r,this.options);this._sequences.push(o)}return this._sequences},n.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},n.prototype.getTotalSequences=function(){return this.getSequences().length},n.prototype.getTree=function(){if(e.prototype.getTree.call(this),this.treeRoot.data.type=t.TreeNodeType.MANIFEST.toString(),!this.isLoaded)return this.treeRoot;if(!this.rootRange)return this.treeRoot;if(this.treeRoot.data=this.rootRange,this.rootRange.treeNode=this.treeRoot,this.rootRange.ranges)for(var n=0;n<this.rootRange.ranges.length;n++){var r=this.rootRange.ranges[n],o=new t.TreeNode;this.treeRoot.addNode(o),this._parseTreeNode(o,r)}return this.generateTreeNodeIds(this.treeRoot),this.treeRoot},n.prototype._parseTreeNode=function(e,n){if(e.label=n.getLabel(),e.data=n,e.data.type=t.TreeNodeType.RANGE.toString(),n.treeNode=e,n.ranges)for(var r=0;r<n.ranges.length;r++){var o=n.ranges[r],i=new t.TreeNode;e.addNode(i),this._parseTreeNode(i,o)}},n.prototype.getManifestType=function(){var e=this.getService(t.ServiceProfile.UIEXTENSIONS);return e?new t.ManifestType(e.getProperty("manifestType")):new t.ManifestType("")},n.prototype.getTrackingLabel=function(){var e=this.getService(t.ServiceProfile.TRACKINGEXTENSIONS);return e?e.getProperty("trackingLabel"):""},n.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},n.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new t.ViewingDirection(this.getProperty("viewingDirection")):t.ViewingDirection.LEFTTORIGHT},n.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new t.ViewingHint(this.getProperty("viewingHint")):t.ViewingHint.EMPTY},n}(t.IIIFResource);t.Manifest=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n),this.collections=[],this.manifests=[],t.__collection=this}return __extends(n,e),n.prototype.getCollectionByIndex=function(t){var e=this.collections[t];return e.load()},n.prototype.getManifestByIndex=function(t){var e=this.manifests[t];return e.load()},n.prototype.getTotalCollections=function(){return this.collections.length},n.prototype.getTotalManifests=function(){return this.manifests.length},n.prototype.getTree=function(){return e.prototype.getTree.call(this),this.treeRoot.data.type=t.TreeNodeType.COLLECTION.toString(),this._parseManifests(this),this._parseCollections(this),this.generateTreeNodeIds(this.treeRoot),this.treeRoot},n.prototype._parseManifests=function(e){if(e.manifests&&e.manifests.length)for(var n=0;n<e.manifests.length;n++){var r=e.manifests[n],o=r.getTree();o.label=r.parentLabel||r.getLabel()||"manifest "+(n+1),o.navDate=r.getNavDate(),o.data.id=r.id,o.data.type=t.TreeNodeType.MANIFEST.toString(),e.treeRoot.addNode(o)}},n.prototype._parseCollections=function(e){if(e.collections&&e.collections.length)for(var n=0;n<e.collections.length;n++){var r=e.collections[n],o=r.getTree();o.label=r.parentLabel||r.getLabel()||"collection "+(n+1),o.navDate=r.getNavDate(),o.data.id=r.id,o.data.type=t.TreeNodeType.COLLECTION.toString(),e.treeRoot.addNode(o),this._parseCollections(r)}},n}(t.IIIFResource);t.Collection=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n),this.ranges=[]}return __extends(n,e),n.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:[]},n.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new t.ViewingDirection(this.getProperty("viewingDirection")):null},n.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new t.ViewingHint(this.getProperty("viewingHint")):null},n}(t.ManifestResource);t.Range=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.getFormat=function(){return new t.RenderingFormat(this.getProperty("format"))},n}(t.ManifestResource);t.Rendering=e}(Manifesto||(Manifesto={}));var _last=require("lodash.last"),Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n),this.canvases=null}return __extends(n,e),n.prototype.getCanvases=function(){if(null!=this.canvases)return this.canvases;this.canvases=[];var e=this.__jsonld.elements||this.__jsonld.canvases;if(e)for(var n=0;n<e.length;n++){var r=e[n],o=new t.Canvas(r,this.options);o.index=n,this.canvases.push(o)}return this.canvases},n.prototype.getCanvasById=function(t){for(var e=0;e<this.getTotalCanvases();e++){var n=this.getCanvasByIndex(e);if(n.id===t)return n}return null},n.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},n.prototype.getCanvasIndexById=function(t){for(var e=0;e<this.getTotalCanvases();e++){var n=this.getCanvasByIndex(e);if(n.id===t)return e}return null},n.prototype.getCanvasIndexByLabel=function(t,e){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),e&&(t+="r"));for(var n,r,o,i,a,u=/(\d*)\D+(\d*)/,s=0;s<this.getTotalCanvases();s++){var c=this.getCanvasByIndex(s);if(c.getLabel()===t)return s;if(n=u.exec(t),n&&(i=n[1],a=n[2],a&&(o="^"+i+"\\D+"+a+"$",r=new RegExp(o),r.test(c.getLabel()))))return s}return-1},n.prototype.getLastCanvasLabel=function(t){for(var e=this.getTotalCanvases()-1;e>=0;e--){var n=this.getCanvasByIndex(e),r=n.getLabel();if(t){var o=/^[a-zA-Z0-9]*$/;if(o.test(r))return r}else if(r)return r}return this.options.defaultLabel},n.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},n.prototype.getNextPageIndex=function(e,n){var r;if(n){var o=this.getPagedIndices(e);r=this.getViewingDirection().toString()===t.ViewingDirection.RIGHTTOLEFT.toString()?o[0]+1:_last(o)+1}else r=e+1;return r>this.getLastPageIndex()?-1:r},n.prototype.getPagedIndices=function(e,n){var r=[];return n?(r=this.isFirstCanvas(e)||this.isLastCanvas(e)?[e]:e%2?[e,e+1]:[e-1,e],this.getViewingDirection().toString()===t.ViewingDirection.RIGHTTOLEFT.toString()&&(r=r.reverse())):r.push(e),r},n.prototype.getPrevPageIndex=function(e,n){var r;if(n){var o=this.getPagedIndices(e);r=this.getViewingDirection().toString()===t.ViewingDirection.RIGHTTOLEFT.toString()?_last(o)-1:o[0]-1}else r=e-1;return r},n.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t)for(var e=0;e<this.getTotalCanvases();e++){var n=this.getCanvasByIndex(e);if(n.id===t)return e}return 0},n.prototype.getThumbs=function(e,n){for(var r=[],o=this.getTotalCanvases(),i=0;o>i;i++){var a=this.getCanvasByIndex(i);r.push(new t.Thumb(e,a))}return r},n.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},n.prototype.getTotalCanvases=function(){return this.getCanvases().length},n.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new t.ViewingDirection(this.getProperty("viewingDirection")):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():t.ViewingDirection.LEFTTORIGHT},n.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new t.ViewingHint(this.getProperty("viewingHint")):t.ViewingHint.EMPTY},n.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},n.prototype.isFirstCanvas=function(t){return 0===t},n.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},n.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},n.prototype.isPagingEnabled=function(){return this.getViewingHint().toString()===t.ViewingHint.PAGED.toString()},n.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2===0},n}(t.ManifestResource);t.Sequence=e}(Manifesto||(Manifesto={}));var _isString=require("lodash.isstring"),Manifesto;!function(t){var e=function(){function e(){}return e.parse=function(t,e){return this.parseJson(JSON.parse(t),e)},e.parseJson=function(t,e){var n;switch(e&&e.navDate&&!isNaN(e.navDate.getTime())&&(t.navDate=e.navDate.toString()),t["@type"]){case"sc:Collection":n=this.parseCollection(t,e);break;case"sc:Manifest":n=this.parseManifest(t,e);break;default:return null}return n.isLoaded=!0,n},e.parseCollection=function(e,n){var r=new t.Collection(e,n);return this.parseCollections(r,n),this.parseManifests(r,n),r},e.parseCollections=function(t,e){var n=t.__jsonld.collections;if(n)for(var r=0;r<n.length;r++){var o=this.parseCollection(n[r],e);o.index=r,o.parentCollection=t,t.collections.push(o)}},e.parseManifest=function(e,n){return new t.Manifest(e,n)},e.parseManifests=function(t,e){var n=t.__jsonld.manifests;if(n)for(var r=0;r<n.length;r++){var o=this.parseManifest(n[r],e);o.index=r,o.parentCollection=t,t.manifests.push(o)}},e}();t.Deserialiser=e;var n=function(){function t(){}return t.serialise=function(t){return""},t}();t.Serialiser=n}(Manifesto||(Manifesto={}));var _endsWith=require("lodash.endswith"),_isArray=require("lodash.isarray"),Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.getProfile=function(){var e=this.getProperty("profile");return e||(e=this.getProperty("dcterms:conformsTo")),_isArray(e)?new t.ServiceProfile(e[0]):new t.ServiceProfile(e)},n.prototype.getDescription=function(){return t.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},n.prototype.getInfoUri=function(){var t=this.id;return _endsWith(t,"/")||(t+="/"),t+="info.json"},n}(t.ManifestResource);t.Service=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(){function t(t,e){this.data=e,this.index=e.index,this.width=t;var n=e.getHeight()/e.getWidth();n&&(this.height=Math.floor(this.width*n)),this.uri=e.getCanonicalImageUri(t),this.label=e.getLabel()}return t}();t.Thumb=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(){function e(t,e){this.label=t,this.data=e||{},this.nodes=[]}return e.prototype.addNode=function(t){this.nodes.push(t),t.parentNode=this},e.prototype.isCollection=function(){return this.data.type===t.TreeNodeType.COLLECTION.toString()},e.prototype.isManifest=function(){return this.data.type===t.TreeNodeType.MANIFEST.toString()},e.prototype.isRange=function(){return this.data.type===t.TreeNodeType.RANGE.toString()},e}();t.TreeNode=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.collection=function(){return new e(e.COLLECTION.toString())},e.prototype.manifest=function(){return new e(e.MANIFEST.toString())},e.prototype.range=function(){return new e(e.RANGE.toString())},e.COLLECTION=new e("sc:collection"),e.MANIFEST=new e("sc:manifest"),e.RANGE=new e("sc:range"),e}(t.StringValue);t.TreeNodeType=e}(Manifesto||(Manifesto={}));var http=require("http"),url=require("url"),Manifesto;!function(t){var e=function(){function e(){}return e.getImageQuality=function(e){var n=e.toString();return n===t.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString()||n===t.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString()||n===t.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString()||n===t.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString()||n===t.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString()||n===t.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString()||n===t.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString()||n===t.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString()||n===t.ServiceProfile.IIIF1IMAGELEVEL1.toString()||n===t.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString()||n===t.ServiceProfile.IIIF1IMAGELEVEL2.toString()||n===t.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString()?"native":"default"},e.getLocalisedValue=function(t,e){if(!_isArray(t))return t;for(var n=0;n<t.length;n++){var r=t[n],o=r["@language"];if(e===o)return r["@value"]}for(var i=e.substr(0,e.indexOf("-")),n=0;n<t.length;n++){var r=t[n],o=r["@language"];if(o===i)return r["@value"]}return null},e.loadResource=function(t){return new Promise(function(e,n){var r=url.parse(t),o=http.request({host:r.hostname,port:r.port,path:r.pathname,method:"GET",withCredentials:!1},function(t){var n="";t.on("data",function(t){n+=t}),t.on("end",function(){e(n)})});o.on("error",function(t){n(t)}),o.end()})},e.loadExternalResource=function(t,n,r,o,i,a,u,s,c,f){return new Promise(function(p,l){f&&f.pessimisticAccessControl?t.getData().then(function(){t.isAccessControlled()?t.clickThroughService?p(r(t)):t.restrictedService?p(o(t)):i(t).then(function(){a(t,!0).then(function(n){t.getData(n).then(function(){p(c(t))})["catch"](function(t){l(e.createInternalServerError(t))})})["catch"](function(t){l(e.createInternalServerError(t))})})["catch"](function(t){l(e.createInternalServerError(t))}):p(t)})["catch"](function(t){l(e.createInternalServerError(t))}):s(t,n).then(function(f){f?t.getData(f).then(function(){t.status===HTTPStatusCode.OK?p(c(t)):e.authorize(t,n,r,o,i,a,u,s).then(function(){p(c(t))})["catch"](function(n){l(t.restrictedService?e.createRestrictedError():e.createAuthorizationFailedError())})})["catch"](function(t){l(e.createAuthorizationFailedError())}):e.authorize(t,n,r,o,i,a,u,s).then(function(){p(c(t))})["catch"](function(t){l(e.createAuthorizationFailedError())})})["catch"](function(t){l(e.createAuthorizationFailedError())})})},e.createError=function(t,e){var n=new Error;return n.message=e,n.name=t,n},e.createAuthorizationFailedError=function(){return e.createError(manifesto.StatusCodes.AUTHORIZATION_FAILED.toString(),"Authorization failed")},e.createRestrictedError=function(){return e.createError(manifesto.StatusCodes.RESTRICTED.toString(),"Restricted")},e.createInternalServerError=function(t){return e.createError(manifesto.StatusCodes.INTERNAL_SERVER_ERROR.toString(),t)},e.loadExternalResources=function(t,n,r,o,i,a,u,s,c,f){return new Promise(function(p,l){var g=_map(t,function(t){return e.loadExternalResource(t,n,r,o,i,a,u,s,c,f)});Promise.all(g).then(function(){p(t)})["catch"](function(t){l(t)})})},e.authorize=function(t,n,r,o,i,a,u,s){return new Promise(function(c,f){t.getData().then(function(){t.isAccessControlled()?s(t,n).then(function(s){s?t.getData(s).then(function(){t.status===HTTPStatusCode.OK?c(t):e.showAuthInteraction(t,n,r,o,i,a,u,c,f)})["catch"](function(t){f(e.createInternalServerError(t))}):a(t,!1).then(function(s){s?u(t,s,n).then(function(){t.getData(s).then(function(){t.status===HTTPStatusCode.OK?c(t):e.showAuthInteraction(t,n,r,o,i,a,u,c,f)})["catch"](function(t){f(e.createInternalServerError(t))})})["catch"](function(t){f(e.createInternalServerError(t))}):e.showAuthInteraction(t,n,r,o,i,a,u,c,f)})})["catch"](function(t){f(e.createInternalServerError(t))}):c(t)})})},e.showAuthInteraction=function(t,n,r,o,i,a,u,s,c){t.status!==HTTPStatusCode.MOVED_TEMPORARILY||t.isResponseHandled?t.restrictedService?s(o(t)):t.clickThroughService&&!t.isResponseHandled?r(t).then(function(){a(t,!0).then(function(r){u(t,r,n).then(function(){t.getData(r).then(function(){s(t)})["catch"](function(t){c(e.createInternalServerError(t))})})["catch"](function(t){c(e.createInternalServerError(t))})})["catch"](function(t){c(e.createInternalServerError(t))})}):i(t).then(function(){a(t,!0).then(function(r){u(t,r,n).then(function(){t.getData(r).then(function(){s(t)})["catch"](function(t){c(e.createInternalServerError(t))})})["catch"](function(t){c(e.createInternalServerError(t))})})["catch"](function(t){c(e.createInternalServerError(t))})}):s(t)},e.getService=function(t,e){var n=this.getServices(t);"string"!=typeof e&&(e=e.toString());for(var r=0;r<n.length;r++){var o=n[r];if(o.getProfile().toString()===e)return o}return null},e.getServiceByReference=function(e,n){for(var r,o=this.getServices(e.options.resource),i=0;i<o.length;i++){var a=o[i];if(a.id===n){r=new t.Service(a.__jsonld,e.options);break}}return r},e.getServices=function(e){var n;n=e.__jsonld?e.__jsonld.service:e.service;var r=[];if(!n)return r;_isArray(n)||(n=[n]);for(var o=0;o<n.length;o++){var i=n[o];_isString(i)&&e!==e.options.resource?r.push(this.getServiceByReference(e,i)):r.push(new t.Service(i,e.options))}return r},e}();t.Utils=e}(Manifesto||(Manifesto={})),global.manifesto=module.exports={AnnotationMotivation:new Manifesto.AnnotationMotivation,ElementType:new Manifesto.ElementType,IIIFResourceType:new Manifesto.IIIFResourceType,ManifestType:new Manifesto.ManifestType,RenderingFormat:new Manifesto.RenderingFormat,ResourceFormat:new Manifesto.ResourceFormat,ResourceType:new Manifesto.ResourceType,ServiceProfile:new Manifesto.ServiceProfile,TreeNodeType:new Manifesto.TreeNodeType,ViewingDirection:new Manifesto.ViewingDirection,ViewingHint:new Manifesto.ViewingHint,StatusCodes:{AUTHORIZATION_FAILED:1,FORBIDDEN:2,INTERNAL_SERVER_ERROR:3,RESTRICTED:4},create:function(t,e){return Manifesto.Deserialiser.parse(t,e)},getService:function(t,e){return Manifesto.Utils.getService(t,e)},getTreeNode:function(){return new Manifesto.TreeNode},isImageProfile:function(t){return t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL0.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL1.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL2.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL0.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL1.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL2.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()},isLevel0ImageProfile:function(t){return t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE0.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL0.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL0.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString()},isLevel1ImageProfile:function(t){return t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL1.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL1.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString()},isLevel2ImageProfile:function(t){return t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString()||t.toString()===Manifesto.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL2.toString()||t.toString()===Manifesto.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL2.toString()||t.toString()===Manifesto.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString();
},loadExternalResources:function(t,e,n,r,o,i,a,u,s,c){return Manifesto.Utils.loadExternalResources(t,e,n,r,o,i,a,u,s,c)},loadManifest:function(t){return Manifesto.Utils.loadResource(t)}};var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.getMotivation=function(){return new t.AnnotationMotivation(this.getProperty("motivation").toLowerCase())},n.prototype.getOn=function(){return this.getProperty("on")},n.prototype.getResource=function(){return new t.Resource(this.getProperty("resource"),this.options)},n}(t.ManifestResource);t.Annotation=e}(Manifesto||(Manifesto={}));var Manifesto;!function(t){var e=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.getFormat=function(){return new t.ResourceFormat(this.getProperty("format").toLowerCase())},n.prototype.getType=function(){return new t.ResourceType(this.getProperty("@type").toLowerCase())},n.prototype.getWidth=function(){return this.getProperty("width")},n.prototype.getHeight=function(){return this.getProperty("height")},n.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},n.prototype.getMaxHeight=function(){var t=this.getProperty("maxHeight");return t?void 0:this.getMaxWidth()},n}(t.ManifestResource);t.Resource=e}(Manifesto||(Manifesto={}));